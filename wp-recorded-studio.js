// Generated by Grafana k6 Studio (1.5.0) on 2025-07-18T14:20:04.073Z

import { group, sleep, check } from "k6";
import http from "k6/http";
import execution from "k6/execution";

export const options = {
  thresholds: {
    http_req_failed: ['rate<0.01'], // http errors should be less than 1%
    http_req_duration: ['p(95)<200'], // 95% of requests should be below 200ms
  },
/*
  stages: [
    { target: 20, duration: "1m" },
    { target: 20, duration: "3m30s" },
    { target: 0, duration: "1m" },
  ],
  */
  scenarios: {
    open_model: {
      executor: 'constant-arrival-rate',
      rate: 5,
      timeUnit: '1s',
      duration: '2m',
      preAllocatedVUs: 20,
      maxVUs: 50,
    },
  },
};

const headers = {
        "Proxy-Connection": `keep-alive`,
        "Upgrade-Insecure-Requests": `1`,
        Accept: `text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7`,
        "Accept-Encoding": `gzip, deflate`,
        "Accept-Language": `en-GB,en-US;q=0.9,en;q=0.8`,
      };

export default function () {
  let params;
  let resp;
  let url;
  const correlation_vars = {};

  group("Sample page", function () {
    params = {
      headers: headers,
      cookies: {},
    };

    url = http.url`http://192.168.3.131:30180/sample-page/`;
    resp = http.request("GET", url, null, params);

    check(resp, { "status equals 200": (r) => r.status === 200 });
  });
  group( "User's Blog!", function () {
    params = {
      headers: {
        ...headers,
        Referer: `http://192.168.3.131:30180/sample-page/`,
      },
      cookies: {},
    };

    url = http.url`http://192.168.3.131:30180/`;
    resp = http.request("GET", url, null, params);

    check(resp, { "status equals 200": (r) => r.status === 200 });
  });
  sleep(Math.random() * (3 - 1) + 1);
}
